<section class="section">
  <div class="section-header">
    <h2 class="mt-0">Your cars</h2>
    <a (click)="showAddForm()" class="button button-primary">Add your car</a>
  </div>
  <!-- ADD: Modal overlay (shown via showAddCar signal) -->
  @if (isFormActive()) {
  <div class="modal-overlay">
    <div
      class="modal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="add-car-title"
    >
      <h3 id="add-car-title">Add a car</h3>

      <form
        [formGroup]="form"
        (ngSubmit)="submitForm()"
        class="modal-form form"
      >
        <input
          class="input"
          type="text"
          formControlName="brand"
          placeholder="Brand..."
          autocomplete="organization"
        />

        <input
          class="input"
          type="text"
          formControlName="model"
          placeholder="Model..."
          autocomplete="off"
        />

        <input
          class="input"
          type="number"
          formControlName="year"
          placeholder="Year of Manufacturing..."
          autocomplete="off"
        />

        <input
          class="input"
          type="text"
          formControlName="countryOfRegistration"
          placeholder="Country of Registration..."
          autocomplete="country-name"
        />

        <input
          class="input"
          type="text"
          formControlName="licensePlateNumber"
          placeholder="License plate number..."
          autocomplete="off"
        />

        <input
          class="input"
          type="text"
          formControlName="vin"
          placeholder="VIN..."
          autocomplete="off"
        />

        <div class="modal-actions">
          <button type="button" class="button" (click)="closeForm()">
            Cancel
          </button>
          <button type="submit" class="button button-primary">Save</button>
        </div>
      </form>
    </div>
  </div>
  }
  <div class="surface">
    <table class="table">
      <thead>
        <tr>
          <th>Make</th>
          <th>Model</th>
          <th>Year</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        @if (carService.loading()) {
        <tr>
          <td colspan="4" class="muted">Loadingâ€¦</td>
        </tr>
        } @else if (carService.error()) {
        <tr>
          <td colspan="4" class="error">{{ carService.error() }}</td>
        </tr>
        } @else if (!carService.cars().length) {
        <tr>
          <td colspan="4" class="muted">No cars found.</td>
        </tr>
        } @else { @for (car of carService.cars(); track car.id) {
        <tr>
          <td>{{ car.brand }}</td>
          <td>{{ car.model }}</td>
          <td>{{ car.year }}</td>
          <td>
            <div class="actions">
              <a class="button" [routerLink]="['/vignette', car.id]"
                >Check toll</a
              >
              <a class="button" (click)="showUpdateForm(car.id)">Edit</a>
            </div>
          </td>
        </tr>
        } }
      </tbody>
    </table>
  </div>
</section>
